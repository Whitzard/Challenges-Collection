from Crypto.Util import number
from secret import flag


nbit = 2048
e = 65537
p, q = number.getPrime(nbit//2), number.getPrime(nbit//2)
N = p * q
# N = 16494639248971076442033680079933457918493793620750178387552347959577664785440773482836577467308100752973494496286243796313790829446473479135750315075512584959925760467718806423291337779929878502365646705398720773008702706031176360564452626264391155448015486259241071582631146065914314223461566189474304619289722051603361908670322074734574274229618032028981884389586916466796776573148950894804341392450870869620830471357649805338529163594039802017978273434663267153515929558901578730607010390954305521099852324101948421463333336525683504864636119286200472416146556137548335067034774509843905544479990626841703952011513
l1, l2 = 100, 100
p0 = p&(2**(nbit//2-l2)-2**l1)
# p0 = 99917482897437895199635813682373273206357564218244757778667963442301578161823440207437183368508989285201613732012541666088833874507232142688122482001728475636215183830793754452651551045803784289284159223441230462284842761501340487849433563779173122393846358611819772932171759616
m = number.bytes_to_long(flag)
c = pow(m, e, N)
# c = 6749135604303616027671910598288045383394316810527504810586885744578489618378207524357472620063102476234052078922708750799947173351608896099423441634665124762089588674889122825631085556395555594314120092634629979699967293516923388902174987931075759715688072929661803697702987474428618168976278093814887782389888301901006932576367970201235218231377387283566119395544478425126258925647240913286809156064924937450665707941430011674559751160648925481938164931968089132479901047079431672891229786529052139472336735317663308742194578717453580377061548834025071728539609662959299450969453364561488725151838083343031209039238