from Crypto.Util.number import getPrime, bytes_to_long
import gmpy2
from secret import hint,flag

assert len(hint)==28

p, q = getPrime(1024), getPrime(1024)
N = p * q
# N = 17012103605310700354558525130721956123624214323459740560748854099841291230041687073253179116382622126489399760155554381280599708646482809280993867844804801507771320844818745965806951051727723208630706951193936685763511959503483771019135305041030022801996555512047985031980251558082928063522159746397285747425942374732290264521388398363376682284495232132867294860564000368999014432701416590785735066639814340582033315172418642751833194010051704042035795811356474061214881837255683717333394766034105182206816275501539939979770544328869870019117382647724305309254546704249436657354465107099716906381681344249197850038677
lam = gmpy2.lcm(p-1, q-1)
d1, d2 = getPrime(700), getPrime(700)
e1, e2 = gmpy2.invert(d1, lam), gmpy2.invert(d2, lam)
# e1 = 610969509950575316279998475393369365507527549105292656474355317673799646126179760097022281953316189823140744626686259326157488713385399226811318619133176439296145400911293669362303072429563208243492066271540185480245901723917128827721248006617686791716279556904425504172430968118228863600286151077778661200985579356764757930825545535970320061388695102242261116344500620482232738147515404714379200673594926455562195250260427079865099661567369830018667837235679670648627623135962414399015505511395458897701468882959809877810323672078875505325021185963139022322551160383994248406718206564364799782074724713769074713407
# e2 = 214840708018774985538131044449149545797524266139635855159917586382427165395408162457178587219909486999943412557546798943208308075230454198945283511612661517117799926685384026627788896657053578891245467846891552485410285202827245865850784971812847705140339525441646660367169646344953958063731420454717189686804154686963396229108579336931542768929454839729079817870659309284935359536262068692128328345807696281082059538542939108342180138581398619069412871411632141145253653572964627607627659986535884660282376234442004507136667981371972089689550403069968447723906213080457212997117800136742913064003762768022220462743
m = bytes_to_long(flag)
c = pow(m, 65537, N)
# c = 10425043086125149449810576787381956680752237833913771975989112577568306843927308547339474392588479343579135157485407824925765206650412387119009049785232993945086715806170313910700641078101353010443757050315444887459173572404646475731545665596359665388878566675712971699870957013109068036338060710615099754691068854696076982149392077634385136703834411120531054448169338948081599578257882177821268252468784752702180969419402930307393161504963249884203640581785452025104442934006654363808843657642563599845277279106361473286291779617398008271374845682587999698260868498825197839854312092396928387134265099932333827583978



#p1, q1 = getPrime(1024), getPrime(1024)
#N1 = p1 * q1
#p0 = p1 ^ (bytes_to_long(hint)<<444)
#assert N1==22752894188316360092540975721906836497991847739424447868959786578153887300450204451741779348632585992639813683087014583667437383610183725778340014971884694702424840759289252997193997614461702362265455177683286566007629947557111478254578643051667900283702126832059297887141543875571396701604215946728406574474496523342528156416445367009267837915658813685925782997542357007012092288854590169727090121416037455857985211971777796742820802720844285182550822546485833511721384166383556717318973404935286135274368441649494487024480611465888320197131493458343887388661805459986546580104914535886977559349182684565216141697843L
#assert p0==165268930359949857026074503377557908247892339573941373503738312676595180929705525120390798235341002232499096629250002305840384250879180463692771724228098578839654230711801010511101603925719055251331144950208399022480638167824839670035053131870941541955431984347563680229468562579668449565647313503239028017367L